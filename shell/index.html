



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="技术博客">
      
      
        <link rel="canonical" href="https://tech.hohoweiya.xyz/shell/">
      
      
        <meta name="author" content="weiya">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.6.0">
    
    
      
        <title>shell - techNotes</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.1b62728e.css">
      
      
    
    
      <script src="../assets/javascripts/modernizr.268332fc.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
    
      
        
<script>
  window.ga = window.ga || function() {
    (ga.q = ga.q || []).push(arguments)
  }
  ga.l = +new Date
  /* Setup integration and send page view */
  ga("create", "UA-85007363-6", "auto")
  ga("set", "anonymizeIp", true)
  ga("send", "pageview")
  /* Register handler to log search on blur */
  document.addEventListener("DOMContentLoaded", () => {
    if (document.forms.search) {
      var query = document.forms.search.query
      query.addEventListener("blur", function() {
        if (this.value) {
          var path = document.location.pathname;
          ga("send", "pageview", path + "?q=" + this.value)
        }
      })
    }
  })
</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#shell" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://tech.hohoweiya.xyz" title="techNotes" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              techNotes
            </span>
            <span class="md-header-nav__topic">
              
                shell
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/szcf-weiya/techNotes" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    szcf-weiya/techNotes
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://tech.hohoweiya.xyz" title="techNotes" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    techNotes
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/szcf-weiya/techNotes" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    szcf-weiya/techNotes
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      Linux
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Linux
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../Linux/" title="一般问题" class="md-nav__link">
      一般问题
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        shell
      </label>
    
    <a href="./" title="shell" class="md-nav__link md-nav__link--active">
      shell
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#shell_1" class="md-nav__link">
    shell变量
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#shell_2" class="md-nav__link">
    shell字符串
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#shell_3" class="md-nav__link">
    shell数组
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sed" class="md-nav__link">
    sed用法
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    |的作用
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#-r" class="md-nav__link">
    -r的作用
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    实战一
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#awk" class="md-nav__link">
    awk
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ip" class="md-nav__link">
    统计访问日志里每个 ip 访问次数
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#split-string-while-reading-files" class="md-nav__link">
    split string while reading files
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#distribute-jobs-into-queues" class="md-nav__link">
    distribute jobs into queues
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#command-line-arguments" class="md-nav__link">
    Command line arguments
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#join-elements-of-an-array-in-bash" class="md-nav__link">
    join elements of an array in Bash
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Linux/servers/" title="服务器" class="md-nav__link">
      服务器
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      R
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        R
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../R/" title="一般问题" class="md-nav__link">
      一般问题
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../R/basic/" title="统计基础" class="md-nav__link">
      统计基础
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../R/plot/" title="plot 作图" class="md-nav__link">
      plot 作图
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../R/ggplot/" title="ggplot 作图" class="md-nav__link">
      ggplot 作图
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../R/legend_from_zhihu/" title="案例分析" class="md-nav__link">
      案例分析
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../R/install-notes-for-rmysql/" title="源码安装 RMySQL" class="md-nav__link">
      源码安装 RMySQL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../R/sample/" title="new sample function (v3.6.0+)" class="md-nav__link">
      new sample function (v3.6.0+)
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Python
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Python
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../python/" title="一般问题" class="md-nav__link">
      一般问题
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../python/pystan/" title="PyStan 体验" class="md-nav__link">
      PyStan 体验
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../python/opencv/" title="OpenCV" class="md-nav__link">
      OpenCV
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../python/finance/" title="金融数据爬虫" class="md-nav__link">
      金融数据爬虫
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../python/rpy2/" title="rpy2" class="md-nav__link">
      rpy2
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../julia/" title="Julia" class="md-nav__link">
      Julia
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../TeX/" title="Tex" class="md-nav__link">
      Tex
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Website
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Website
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../website/" title="Website" class="md-nav__link">
      Website
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../website/" title="CSS" class="md-nav__link">
      CSS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../js/" title="JS" class="md-nav__link">
      JS
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Internet/" title="Network" class="md-nav__link">
      Network
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">
    
    <label class="md-nav__link" for="nav-9">
      Tools
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        Tools
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../autotools/" title="Autotools" class="md-nav__link">
      Autotools
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Emacs/" title="Emacs" class="md-nav__link">
      Emacs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../vi/" title="Vi" class="md-nav__link">
      Vi
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ssh/" title="Ssh" class="md-nav__link">
      Ssh
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Git/" title="Git" class="md-nav__link">
      Git
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../phantomjs/" title="Phantomjs" class="md-nav__link">
      Phantomjs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Qt/" title="Qt" class="md-nav__link">
      Qt
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10">
    
    <label class="md-nav__link" for="nav-10">
      Math
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-10">
        Math
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../stats/" title="Stats" class="md-nav__link">
      Stats
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../scientific/" title="Scientific" class="md-nav__link">
      Scientific
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../matrix/" title="Matrix" class="md-nav__link">
      Matrix
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../English/" title="English" class="md-nav__link">
      English
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../finance/" title="Finance" class="md-nav__link">
      Finance
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../mi/" title="Mi" class="md-nav__link">
      Mi
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../win/" title="Win" class="md-nav__link">
      Win
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../fresh/" title="Fresh" class="md-nav__link">
      Fresh
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../links/" title="Links" class="md-nav__link">
      Links
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-17" type="checkbox" id="nav-17">
    
    <label class="md-nav__link" for="nav-17">
      Misc
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-17">
        Misc
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../misc/wx/" title="小程序" class="md-nav__link">
      小程序
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../misc/wxjssdk/" title="jssdk" class="md-nav__link">
      jssdk
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../misc/report/" title="讲座" class="md-nav__link">
      讲座
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-18" type="checkbox" id="nav-18">
    
    <label class="md-nav__link" for="nav-18">
      Others
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-18">
        Others
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../Matlab/" title="Matlab" class="md-nav__link">
      Matlab
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Cpp/" title="Cpp" class="md-nav__link">
      Cpp
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../java/" title="Java" class="md-nav__link">
      Java
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../SQL/" title="SQL" class="md-nav__link">
      SQL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cuda/" title="Cuda" class="md-nav__link">
      Cuda
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../PHP/" title="PHP" class="md-nav__link">
      PHP
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#shell_1" class="md-nav__link">
    shell变量
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#shell_2" class="md-nav__link">
    shell字符串
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#shell_3" class="md-nav__link">
    shell数组
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sed" class="md-nav__link">
    sed用法
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    |的作用
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#-r" class="md-nav__link">
    -r的作用
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    实战一
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#awk" class="md-nav__link">
    awk
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ip" class="md-nav__link">
    统计访问日志里每个 ip 访问次数
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#split-string-while-reading-files" class="md-nav__link">
    split string while reading files
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#distribute-jobs-into-queues" class="md-nav__link">
    distribute jobs into queues
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#command-line-arguments" class="md-nav__link">
    Command line arguments
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#join-elements-of-an-array-in-bash" class="md-nav__link">
    join elements of an array in Bash
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="shell">shell相关<a class="headerlink" href="#shell" title="Permanent link">&para;</a></h1>
<p>教程参考</p>
<ol>
<li><a href="http://www.runoob.com/linux/linux-shell.html">菜鸟教程</a></li>
</ol>
<h2 id="shell_1">shell变量<a class="headerlink" href="#shell_1" title="Permanent link">&para;</a></h2>
<ol>
<li>定义变量时，变量名不加美元符号</li>
<li>变量名和等号之间不能有空格</li>
<li>变量名外面的花括号是可选的，加不加都行，加花括号是为了帮助解释器识别变量的边界，比如下面这种情况：
<div class="codehilite"><pre><span></span><span class="k">for</span> skill in Ada Coffe Action Java<span class="p">;</span> <span class="k">do</span>
    <span class="nb">echo</span> <span class="s2">&quot;I am good at </span><span class="si">${</span><span class="nv">skill</span><span class="si">}</span><span class="s2">Script&quot;</span>
<span class="k">done</span>
</pre></div></li>
</ol>
<h2 id="shell_2">shell字符串<a class="headerlink" href="#shell_2" title="Permanent link">&para;</a></h2>
<ol>
<li>单引号里的任何字符都会原样输出，单引号字符串中的变量是无效的；</li>
<li>单引号字串中不能出现单引号（对单引号使用转义符后也不行）。</li>
<li>双引号里可以有变量</li>
<li>双引号里可以出现转义字符</li>
</ol>
<h2 id="shell_3">shell数组<a class="headerlink" href="#shell_3" title="Permanent link">&para;</a></h2>
<ol>
<li>在Shell中，用括号来表示数组，数组元素用“空格”符号分割开。</li>
</ol>
<h2 id="sed">sed用法<a class="headerlink" href="#sed" title="Permanent link">&para;</a></h2>
<p>参考</p>
<ol>
<li><a href="http://man.linuxde.net/sed">sed命令_Linux sed 命令用法详解：功能强大的流式文本编辑器</a></li>
<li><a href="https://www.cnblogs.com/nhlinkin/p/3647357.html">sed &amp; awk常用正则表达式 - 菲一打 - 博客园</a></li>
</ol>
<h2 id="_1"><code>|</code>的作用<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<blockquote>
<p>竖线(|)元字符是元字符扩展集的一部分，用于指定正则表达式的联合。如果某行匹配其中的一个正则表达式，那么它就匹配该模式。</p>
</blockquote>
<h2 id="-r"><code>-r</code>的作用<a class="headerlink" href="#-r" title="Permanent link">&para;</a></h2>
<p>也就是使用扩展的正则表达式</p>
<p>参考<a href="https://www.gnu.org/software/sed/manual/html_node/Extended-regexps.html">Extended regexps - sed, a stream editor</a></p>
<p>摘录如下</p>
<blockquote>
<p>The only difference between basic and extended regular expressions is in the behavior of a few characters: ‘?’, ‘+’, parentheses, and braces (‘{}’). While basic regular expressions require these to be escaped if you want them to behave as special characters, when using extended regular expressions you must escape them if you want them to match a literal character.</p>
</blockquote>
<p>就是说 basic 模式下，要使用特殊字符（如正则表达式中）需要转义，但extended模式相反，转义后表达的是原字符。</p>
<p>举个例子</p>
<ol>
<li><code>abc?</code> becomes <code>abc\?</code> when using extended regular expressions. It matches the literal string ‘abc?’. </li>
<li><code>c\+</code> becomes <code>c+</code> when using extended regular expressions. It matches one or more ‘c’s. </li>
<li><code>a\{3,\}</code> becomes <code>a{3,}</code> when using extended regular expressions. It matches three or more ‘a’s. </li>
<li><code>\(abc\)\{2,3\}</code> becomes <code>(abc){2,3}</code> when using extended regular expressions. It matches either <code>abcabc</code> or <code>abcabcabc</code>.</li>
<li><code>\(abc*\)\1</code> becomes <code>(abc*)\1</code> when using extended regular expressions. Backreferences must still be escaped when using extended regular expressions.</li>
</ol>
<h3 id="_2">实战一<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h3>
<p>将</p>
<div class="codehilite"><pre><span></span><span class="err">!</span><span class="o">[</span><span class="n">IMG_0802</span><span class="o">]</span><span class="p">(</span><span class="nl">https</span><span class="p">:</span><span class="o">//</span><span class="k">user</span><span class="o">-</span><span class="n">images</span><span class="p">.</span><span class="n">githubusercontent</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="mi">13688320</span><span class="o">/</span><span class="mi">72489850</span><span class="o">-</span><span class="mi">733</span><span class="n">ae480</span><span class="o">-</span><span class="mi">3850</span><span class="o">-</span><span class="mi">11</span><span class="n">ea</span><span class="o">-</span><span class="mf">8e51</span><span class="o">-</span><span class="mi">15021588</span><span class="n">a7e6</span><span class="p">.</span><span class="n">jpg</span><span class="p">)</span><span class="w"></span>
</pre></div>

<p>替换成</p>
<div class="codehilite"><pre><span></span><span class="o">[</span><span class="n">IMG_0802</span><span class="o">]</span><span class="err">:</span><span class="w"> </span><span class="nl">https</span><span class="p">:</span><span class="o">//</span><span class="k">user</span><span class="o">-</span><span class="n">images</span><span class="p">.</span><span class="n">githubusercontent</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="mi">13688320</span><span class="o">/</span><span class="mi">72489850</span><span class="o">-</span><span class="mi">733</span><span class="n">ae480</span><span class="o">-</span><span class="mi">3850</span><span class="o">-</span><span class="mi">11</span><span class="n">ea</span><span class="o">-</span><span class="mf">8e51</span><span class="o">-</span><span class="mi">15021588</span><span class="n">a7e6</span><span class="p">.</span><span class="n">jpg</span><span class="w"></span>
</pre></div>

<p>解决方案</p>
<div class="codehilite"><pre><span></span>sed -i <span class="s2">&quot;s/\!\[IMG_\([0-9]\{4\}\)\](\(.*\))/\[IMG_\1\]\: \2/g&quot;</span> FILENAME
</pre></div>

<ul>
<li><code>\(\)</code> 用于匹配子串，并可以通过 <code>\1</code>, <code>\2</code> 引用</li>
<li><code>\!</code> 需要 escape</li>
<li><code>\2</code> 前面的空格不需要写成 <code>[ ]</code>，不然会直接出现 <code>[ ]</code>，而之前某次为了匹配多个空格需要写成 <code>[ ]*</code></li>
</ul>
<h2 id="awk">awk<a class="headerlink" href="#awk" title="Permanent link">&para;</a></h2>
<p>参考<a href="https://linux.cn/article-3945-1.html">技术|如何在Linux中使用awk命令</a></p>
<h2 id="ip">统计访问日志里每个 ip 访问次数<a class="headerlink" href="#ip" title="Permanent link">&para;</a></h2>
<div class="codehilite"><pre><span></span><span class="ch">#!/bin/bash</span>
cat access.log <span class="p">|</span>sed -rn <span class="s1">&#39;/28\/Jan\/2015/p&#39;</span> &gt; a.txt 
cat a.txt <span class="p">|</span>awk <span class="s1">&#39;{print $1}&#39;</span><span class="p">|</span>sort <span class="p">|</span>uniq &gt; ipnum.txt
<span class="k">for</span> i in <span class="sb">`</span>cat ipnum.txt<span class="sb">`</span><span class="p">;</span> <span class="k">do</span>
    <span class="nv">iptj</span><span class="o">=</span><span class="sb">`</span>cat  access.log <span class="p">|</span>grep <span class="nv">$i</span> <span class="p">|</span> grep -v <span class="m">400</span> <span class="p">|</span>wc -l<span class="sb">`</span>
    <span class="nb">echo</span> <span class="s2">&quot;ip地址&quot;</span><span class="nv">$i</span><span class="s2">&quot;在2015-01-28日全天(24小时)累计成功请求&quot;</span><span class="nv">$iptj</span><span class="s2">&quot;次，平均每分钟请求次数为：&quot;</span><span class="k">$((</span><span class="nv">$iptj</span><span class="o">/</span><span class="m">1440</span><span class="k">))</span> &gt;&gt; result.txt
<span class="k">done</span>
</pre></div>

<p>Refer to <a href="https://www.cnblogs.com/paul8339/p/6207182.html">用shell统计访问日志里每个ip访问次数</a></p>
<h2 id="split-string-while-reading-files">split string while reading files<a class="headerlink" href="#split-string-while-reading-files" title="Permanent link">&para;</a></h2>
<p>specify <code>IFS=</code>.</p>
<ol>
<li><a href="https://stackoverflow.com/questions/19719827/how-to-split-a-tab-delimited-string-in-bash-script-without-collapsing-blanks">How to split a tab-delimited string in bash script WITHOUT collapsing blanks?</a> </li>
<li><a href="https://stackoverflow.com/questions/27500692/split-string-in-shell-script-while-reading-from-file">Split String in shell script while reading from file</a></li>
<li><a href="https://stackoverflow.com/questions/10929453/read-a-file-line-by-line-assigning-the-value-to-a-variable">Read a file line by line assigning the value to a variable</a> </li>
</ol>
<h2 id="distribute-jobs-into-queues">distribute jobs into queues<a class="headerlink" href="#distribute-jobs-into-queues" title="Permanent link">&para;</a></h2>
<p>since different queues has different quota, try to assign the job into available nodes.</p>
<div class="codehilite"><pre><span></span><span class="nv">queue</span><span class="o">=(</span>bigmem large batch<span class="o">)</span>
<span class="nv">queues</span><span class="o">=()</span>
<span class="k">for</span> <span class="o">((</span><span class="nv">i</span><span class="o">=</span><span class="m">0</span><span class="p">;</span>i&lt;<span class="m">12</span><span class="p">;</span>i++<span class="o">))</span> <span class="k">do</span> <span class="nv">queues</span><span class="o">+=(</span><span class="si">${</span><span class="nv">queue</span><span class="p">[0]</span><span class="si">}</span><span class="o">)</span><span class="p">;</span> <span class="k">done</span><span class="p">;</span>
<span class="k">for</span> <span class="o">((</span><span class="nv">i</span><span class="o">=</span><span class="m">0</span><span class="p">;</span>i&lt;<span class="m">20</span><span class="p">;</span>i++<span class="o">))</span> <span class="k">do</span> <span class="nv">queues</span><span class="o">+=(</span><span class="si">${</span><span class="nv">queue</span><span class="p">[1]</span><span class="si">}</span><span class="o">)</span><span class="p">;</span> <span class="k">done</span><span class="p">;</span>
<span class="k">for</span> <span class="o">((</span><span class="nv">i</span><span class="o">=</span><span class="m">0</span><span class="p">;</span>i&lt;<span class="m">15</span><span class="p">;</span>i++<span class="o">))</span> <span class="k">do</span> <span class="nv">queues</span><span class="o">+=(</span><span class="si">${</span><span class="nv">queue</span><span class="p">[2]</span><span class="si">}</span><span class="o">)</span><span class="p">;</span> <span class="k">done</span><span class="p">;</span>
</pre></div>

<p>refer to</p>
<ul>
<li><a href="https://stackoverflow.com/questions/1951506/add-a-new-element-to-an-array-without-specifying-the-index-in-bash">Add a new element to an array without specifying the index in Bash</a></li>
<li><a href="https://stackoverflow.com/questions/29205213/repeat-an-element-n-number-of-times-in-an-array">Repeat an element n number of times in an array</a></li>
<li><a href="http://tldp.org/LDP/abs/html/dblparens.html">The Double-Parentheses Construct</a></li>
<li><a href="https://stackoverflow.com/questions/21035121/increment-variable-value-by-1-shell-programming">Increment variable value by 1 ( shell programming)</a></li>
<li><a href="http://www.runoob.com/linux/linux-shell-array.html">Shell 数组</a></li>
</ul>
<h2 id="command-line-arguments">Command line arguments<a class="headerlink" href="#command-line-arguments" title="Permanent link">&para;</a></h2>
<p>refer to <a href="https://www.devdungeon.com/content/taking-command-line-arguments-bash">Taking Command Line Arguments in Bash</a></p>
<h2 id="join-elements-of-an-array-in-bash">join elements of an array in Bash<a class="headerlink" href="#join-elements-of-an-array-in-bash" title="Permanent link">&para;</a></h2>
<div class="codehilite"><pre><span></span>arr=(a b c)
printf &#39;%s\n&#39; &quot;$(IFS=,; printf &#39;%s&#39; &quot;<span class="cp">${</span><span class="n">arr</span><span class="p">[</span><span class="o">*</span><span class="p">]</span><span class="cp">}</span>&quot;)&quot;
</pre></div>

<p>refer to <a href="https://stackoverflow.com/questions/1527049/how-can-i-join-elements-of-an-array-in-bash">How can I join elements of an array in Bash?</a></p>
                
                  
                
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../Linux/" title="一般问题" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                一般问题
              </span>
            </div>
          </a>
        
        
          <a href="../Linux/servers/" title="服务器" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                服务器
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2017-2020 weiya
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/szcf-weiya" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://esl.hohoweiya.xyz" class="md-footer-social__link fa fa-book"></a>
    
      <a href="https://hohoweiya.xyz" class="md-footer-social__link fa fa-home"></a>
    
      <a href="https://blog.hohoweiya.xyz" class="md-footer-social__link fa fa-rss"></a>
    
      <a href="mailto:szcfweiya@gmail.com" class="md-footer-social__link fa fa-envelope"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.808e90bb.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
        <script src="../javascripts/baiduzhanzhang.js"></script>
      
        <script src="../javascripts/extra.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
  </body>
</html>